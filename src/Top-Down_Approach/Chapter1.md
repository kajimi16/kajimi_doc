# 计算机网络和因特网

相对于 CSAPP，这本书的开头就让我感受到压力倍增，它在 30 面的篇幅里面抛出了更多对我来说全新的专业名词，并且对其的解释经常发生耦合和互相解释的情况。
不过正如这本书说的,**“如果你想在家庭聚会上一鸣惊人，看完第一章就应当由足够的知识来给家人和朋友留下一些深刻印象了”**
总之，这些知识只是纯粹给你留下一些初步的印象，前面的区域以后再来探索吧

### 1.1 什么是因特网

#### 1.1.1 具体构成描述

因特网就是一个连接了全世界数十亿计算设备的网络。
这些计算设备有传统的电脑，也有手机之类的移动设备，还有家用电器之类的非传统设备。
这些各种各样的计算设备被统称为**主机**或**端系统**，它们之间通过**通信链路**和**分组交换机**相互连接。  
对于链路，它肯定是有传输速率的，以 bps（比特每秒）度量。而在端系统发送数据时，通常会将数据分段
，再加上首部字节（一些类似于上下文的标记），形成的数据包就叫做**分组**。
而分组交换机就是接受通信链路传来的分组再把它通过另外一条通信链路发出去的设备，比如**路由器和链路层交换机**
就像从一个工厂到另外一个工厂（端系统），中间货物（数据）被分装到不同的卡车（分组），经过高速公路（通信链路）和交叉口（分组交换机），最终到达目的地一样，分组通过的通信链路和分组交换机被叫做**路径**。  
端系统通过**因特网服务提供商（ISP）**接入互联网，简单来说就是移动联通电信这些的运营商，你得向他们交钱来拿到互联网服务。  
然后呢，我们知道，数据的传输需要一些通用的规矩，这些规矩被叫做**协议**，比如我们的 TCP/IP 协议，就是协议。  
因为协议必须像一些共识一样才能发挥互联的作用（就像两个人必须有共通的语言才能交流一样），**因特网标准**产生了，一个叫 IETF 的组织研发了它，它们给出了一堆叫**请求评论**的官方文档，里面定义了各种协议。

#### 1.1.2 服务描述

讲了这么多，似乎和我们的日常生活没有什么强而有力的关联，那么我们从**分布式应用**的角度来讲（就是我们平时电脑手机里面的各种联网 app，它们一般涉及了各个端系统之间的交互）。
为了实现分布式应用的各种联网功能，端系统提供了**套接字接口**，规定了不同端系统的程序之间交接数据的方式。借用书里的类比，你像别人写信，但不能只写信，你害得写一些信要给谁，送到哪里，邮政编码之类的信息，才能让信送到。同理，数据也是一样的。

#### 1.1.3 什么是协议

你知道的的，详细的语言描述有时候不如来点比喻，用人类的比喻来说，很多人在找别人说事情前喜欢先发一句“在吗？”，再通过对面的反应来继续下文，要是对面没回或者发动了自动回复，那肯定就不能说事情了
这种对于接受和回答的报文的采取的约定俗成的行为模式，就是**协议**。
网络协议就像是人类的协议一样，不同的设备按照协议的规矩进行交流进行互联网上的通信。
专业来说，**协议**定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文的发送或接受以及其他事件所采取的操作。

### 1.2 网络边缘

接下来，我们将从外到内粗略地遍历因特网这张巨大的网，在互联网边缘的肯定是我们的端系统了，我们通常听到的**客户端和服务器**，就是端系统的两种角色。
客户端就是我们常用的电脑手机之类的，各种应用程序运行在上面，而服务器通常是一些更加强大的设备，里面存储了许多的信息，并承担了这些信息发布的工作，这些信息包括我们联网得到的视频，图片，文章之类的。

#### 1.2.1 接入网

##### 家庭接入

从边缘向内，接入网就是将端系统物理连接到**边缘路由器**（就是端系统到另一个端系统路径上的第一台路由器）的网络。
现在最流行的接入网有两种，**数字用户线（DSL）**和**电缆**
以下内容开始包含不负责任的大胆猜想和各种不知名网页内容
简单来说就是给传统的有线座机的电话线加上了联网的功能，我们在家里加上**DSL 调制解调器**，把数字信号变成高频音，发送到电话公司的**数字用户线接入复用器（DSLAM）**，变回数字形式。这种额外功能是通过将电话信号分成 3 种频段

- 高速下行信道 （50kHZ~1MHz）
- 中速上行信道 （4kHz~50kHz）
- 普通的双向电话信道（0~4kHz）
  这种把分割不同频率的信号并变成不同信息的操作让一条电话线兼具了电话和联网的功能，于是家里就连上网了。这种操作只能说省钱又省事。
  **电缆因特网接入**则是利用了有线电视基础设施的电缆，那么进行类比，它的**电缆调制解调器**就相当于 DSL 调制解调器，**电缆调制解调器端接系统（CMTS）**就相当于 DSLAM
  当然，还有一些其他宽带接入技术，比如
- **光纤到户（FTTH）** 从本地中心局（类似于 CMTS 和 DSLAM 放在的地方）连一条光纤到一个地区，然后通过**光纤分配器**把一条光纤变成多条，分配给多个家庭。同样也有一个类似调制解调器的东西即**光纤线路端接器**把光信号和电信号进行转换
- **5G 固定式无线**采用无线方式从供应商的基站发送数据，通过家里的调制解调器接收，再连到 WiFi 无限路由器上。

##### 企业（和家庭）接入

而在学校和家庭环境里，**局域网（LAN）**明显更加常见，最常见的（感觉是写书时最常见的）是**以太网**。就是我们学校机房里面那种有线的连接，把设备统一链接到以太网交换机，然后再接到路由器。
而基于 IEEE802.11 技术的无线 LAN 接入，说人话就是**WiFi**，才是真正无所不在。
现在毫无疑问，WiFi 已经走入家家户户了，现在的家庭网络通常由

- **无线接入点**（与无线设备通信的基站）
- **无线路由器**（无线接入点和其他无线设备与因特网相连的设备）
- **无线设备**（手机，电脑，路由器，打印机等）
- **有线 PC**（就是那种接网线的台式机）

##### 广域无线接入

简单理解就是俗称的移动数据（流量）东西，通过和蜂窝移动电话一样的基础设施，实现了随时随地联网的能力，现在我们已经有 3G、4G、5G 无线技术了。

#### 1.2.2 物理媒介

我们的数据在穿来穿去的过程中肯定需要一些媒介对吧，毕竟我们的电磁波或者光脉冲或者什么东西不能凭空传送对吧。
它们跨越的**物理媒介**被分为

- **导引型媒介** （固体媒介，比如双绞铜线，光缆等）
- **非导引型媒介**（空气或外层空间）

书里主要介绍了五种

- 双绞铜线 最便宜，最常见，最古老，电话线基本是双绞铜线
- 同轴电缆 电视系统中最常见
- 光纤 又快又稳定，被认为是因特网的主干，就是太贵了
- 陆地无线电信道 不需要物理线路，可以穿墙，移动连接，
- 卫星无线电信道 还在开发说是

### 1.3 网络核心

你以为之前的已经够干了，实则后面还有更干的
我们继续深入计算机网络，现在我们的信息已经进入第一个路由器，我们来到更多分组交换机和通信链路组成的网络核心，一个网状网络。

#### 1.3.1 分组交换

在网络应用中，端系统彼此交换**报文**，它可以是控制用，也可以是数据，我们的分组就是被切块的报文。此事在上文已有记载

##### 存储转发传输

简单来说对于一个分组的传输，我们要先在路由器里面拿到它的所有比特（存储），再向下一条通信链路发送（转发）。
比如给目的地发一个分组，中间经过两条通信链路和一个路由器，假设我们忽略传播时延（在通信链路上传播的时间），只考虑传输时延（路由器发货信息需要的时间）并设置为 t，那么我们需要等 2t 时间而不是 t 时间，因为中间的路由器要求等到 t 秒时分组完全到达时再进行转发，接下来还要 t 时间发货，所以总共 2t 时间。
